if(void 0===OneStop)var OneStop={};if(OneStop.Analytics={cookieName:"_onestop4writers_mp",utmCookieName:"_onestop4writers_utm",get utmMappings(){return JSON.parse('{"utmca":"utm_campaign","utmco":"utm_content","utmm":"utm_medium","utms":"utm_source","utmt":"utm_term"}')},get referrer(){if(0==document.referrer.length)return document.referrer;return new URL(document.referrer).host===window.location.host?"":document.referrer},collectUtmParams:function(e=!1){const t=new URLSearchParams(window.location.search),s={};return Object.keys(this.utmMappings).forEach(n=>{const i=this.utmMappings[n];s[e?i:n]=t.get(i)}),this.stripEmptyProps(s)},utmParamsAsTraits:function(){if(this._utmParamsAsTraits)return this._utmParamsAsTraits;this._utmParamsAsTraits={};const e=this.utmParams(),t={utmcaF:"utm_campaign [first touch]",utmcoF:"utm_content [first touch]",utmmF:"utm_medium [first touch]",utmsF:"utm_source [first touch]",utmtF:"utm_term [first touch]",utmcaL:"utm_campaign [last touch]",utmcoL:"utm_content [last touch]",utmmL:"utm_medium [last touch]",utmsL:"utm_source [last touch]",utmtL:"utm_term [last touch]"};return Object.keys(e).forEach(s=>{this._utmParamsAsTraits[t[s]]=e[s]}),this._utmParamsAsTraits},utmParams:function(){if(this._utmParams)return this._utmParams;this._utmParams={};let e=$.cookie(this.utmCookieName);const t=this.stripEmptyProps(this.collectUtmParams());return e?(this._utmParams=JSON.parse(decodeURIComponent(atob(e))),Object.keys(t).length>0&&Object.keys(this.utmMappings).forEach(e=>{this._utmParams[`${e}L`]=t[e]||null})):Object.keys(t).forEach(e=>{this._utmParams[`${e}F`]=t[e],this._utmParams[`${e}L`]=t[e]}),Object.keys(this._utmParams).length>0&&$.cookie(this.utmCookieName,btoa(encodeURIComponent(JSON.stringify(this._utmParams))),{path:"/",expires:3650}),this._utmParams},eventData:function(){if(this._eventData)return this._eventData;const e=this.props(),t=JSON.parse('{"$initial_referrer":"ir","$initial_referring_domain":"ird","$search_engine":"se","mp_keyword":"sk","$network_connection_speed":"nc","$os":"os","$screen_width":"sw","$screen_height":"sh","$browser_width":"bw","$browser_height":"bh","$device":"de"}'),s={...OneStop.User};Object.keys(t).forEach(n=>{s[n]=e[t[n]]});const n=this.utmParams();return Object.keys(n).filter(e=>e.endsWith("L")).forEach(e=>{s[this.utmMappings[e.slice(0,-1)]]=n[e]}),this._eventData=this.stripEmptyProps(s),this._eventData},props:function(){if(this._data)return this._data;const e=(e=[])=>{const t={};return e.includes("ir")||(t.ir=this.initialReferrer()||"$direct"),e.includes("ird")||(t.ird=this.initialReferringDomain()||"$direct"),e.includes("se")||(t.se=this.searchEngine()),e.includes("sk")||(t.sk=this.searchKeyword()),e.includes("nc")||(t.nc=this.networkConnection()),e.includes("os")||(t.os=this.os()),e.includes("sw")||(t.sw=window.screen.width),e.includes("sh")||(t.sh=window.screen.height),e.includes("bw")||(t.bw=jQuery(window).width()),e.includes("bh")||(t.bh=jQuery(window).height()),e.includes("de")||(t.de=this.device()),t};let t=$.cookie(this.cookieName);return this._data=t?this.stripEmptyProps({...JSON.parse(decodeURIComponent(atob(t))),...e(["ir","ird","se","sk"])}):this.stripEmptyProps(e()),$.cookie(this.cookieName,btoa(encodeURIComponent(JSON.stringify(this._data))),{path:"/"}),this._data},stripEmptyProps:function(e){const t={};return Object.keys(e).forEach(s=>{const n=e[s];switch(typeof n){case"string":0!==n.trim().length&&(t[s]=n.trim());break;case"undefined":break;case"object":null!==n&&(t[s]=n);break;default:t[s]=n}}),t},getQueryParam:function(e,t){t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");const s=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);if(null===s||s&&"string"!=typeof s[1]&&s[1].length)return"";{let e=s[1];try{e=decodeURIComponent(e)}catch(n){console.error("Skipping decoding for malformed query param: "+e)}return e.replace(/\+/g," ")}},searchEngine:function(){return 0===this.referrer.search("https?://(.*)google.([^/?]*)")?"google":0===this.referrer.search("https?://(.*)bing.com")?"bing":0===this.referrer.search("https?://(.*)yahoo.com")?"yahoo":0===this.referrer.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchKeyword:function(){const e=this.searchEngine();if(null===e)return null;const t="yahoo"!=e?"q":"p",s=this.getQueryParam(this.referrer,t);return s.trim().length>0?s.trim().toLowerCase():null},initialReferrer:function(){return this.referrer.length>0?this.referrer:null},initialReferringDomain:function(){const e=this.referrer.split("/");return e.length>=3?e[2]:null},networkConnection:function(){return navigator.connection&&navigator.connection.effectiveType?navigator.connection.effectiveType:"n/a"},os:function(){const e=navigator.userAgent;return/Windows/i.test(e)?/Phone/.test(e)||/WPDesktop/.test(e)?"Windows Phone":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"Mac OS X":/Linux/.test(e)?"Linux":/CrOS/.test(e)?"Chrome OS":null},device:function(){const e=navigator.userAgent;return/Windows Phone/i.test(e)||/WPDesktop/.test(e)?"Windows Phone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Android/.test(e)?"Android":"Desktop"}},void 0===OneStop)OneStop={};if(OneStop.Banner={COOKIE_NAME:"_onestop4writers_dismissedBanner"},OneStop.Banner.init=function(e,t){this.bannerElem=e,this.updatedAt=t.toString(),this.dismissedBanner=this.loadDismissedBanner(),this.dismissedBanner==this.updatedAt?this.hideBanner():this.showBanner()},OneStop.Banner.loadDismissedBanner=function(){return($.cookie(this.COOKIE_NAME)||"").trim()},OneStop.Banner.saveDismissedBanner=function(){this.dismissedBanner=this.updatedAt;const e=new Date;e.setYear(e.getFullYear()+10),$.cookie(this.COOKIE_NAME,this.dismissedBanner,{expires:e,path:"/"})},OneStop.Banner.showBanner=function(){this.bannerElem.classList.remove("hidden"),this.attachHandlers()},OneStop.Banner.hideBanner=function(){this.bannerElem.remove()},OneStop.Banner.attachHandlers=function(){this.bannerElem.querySelectorAll("[data-dismiss='banner']").forEach(e=>{e.addEventListener("click",this.dismiss.bind(this))})},OneStop.Banner.dismiss=function(e){e.preventDefault(),e.stopPropagation(),this.saveDismissedBanner(),this.hideBanner()},void 0===OneStop)OneStop={};if(OneStop.FlashMessages={},OneStop.FlashMessages.show=function(e,t){var s=document.createElement("p");s.classList.add(t),s.classList.add("alert"),s.classList.add("alert-dismissible"),button_tag='<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>',s.innerHTML=e+button_tag,jQuery("#flash-messages").append(s)},void 0===OneStop)OneStop={};if(OneStop.SearchFilters={},OneStop.SearchFilters.init=function(){jQuery(".search-exclude").on("change",OneStop.SearchFilters.regenerateExcludeInputs),jQuery("#select-all").click(function(){OneStop.SearchFilters.setAllFiltersTo(!0)}),jQuery("#deselect-all").click(function(){OneStop.SearchFilters.setAllFiltersTo(!1)}),jQuery("#update-filters").click(function(){OneStop.SearchFilters.updateFilterCache(),jQuery("#search-form").submit()})},OneStop.SearchFilters.regenerateExcludeInputs=function(){jQuery("#search-form > .exclude_").remove(),jQuery(".search-exclude").each(function(e,t){$ele=jQuery(t),is_checked=$ele.is(":checked"),resource_class=$ele.attr("value"),is_checked||jQuery("#search-form").append('<input type="hidden" name="exclude[]" class="exclude_" value="'+resource_class+'">')})},OneStop.SearchFilters.setAllFiltersTo=function(e){jQuery(".search-exclude").each(function(t,s){jQuery(s).prop("checked",e)}),OneStop.SearchFilters.regenerateExcludeInputs()},OneStop.SearchFilters.updateFilterCache=function(){const e=jQuery("#search-form .exclude_").map(function(e,t){return jQuery(t).val()}).toArray().join();jQuery.cookie("onestop_search_exclude_filters",e)},void 0===OneStop)OneStop={};if(OneStop.ImageTips={init:function(){jQuery(".thumbnail-img").each(function(){var e=jQuery(this);e.popover({html:!0,trigger:"hover",container:e,placement:"auto bottom",content:function(){return'<img src="'+jQuery(this).data("img-url")+'" />'}})})}},void 0===OneStop)OneStop={};if(OneStop.ShowPassword={},OneStop.ShowPassword.init=function(e){jQuery(e).on("click",OneStop.ShowPassword.toggle)},OneStop.ShowPassword.toggle=function(){const e=jQuery(this).siblings("input")[0];e&&(e.type="password"==e.type?"text":"password",jQuery(this).toggleClass("glyphicon-eye-close","glyphicon-eye-open"))},void 0===OneStop)OneStop={};OneStop.StoryMaps={},OneStop.StoryMaps.HelpDialog={},OneStop.StoryMaps.HelpDialog.init=function(){this.dialog=jQuery("#dialog"),this.dialog.modal({backdrop:!1,keyboard:!1,show:!1}),jQuery(".help-dialog-button").on("click",e=>{$this=jQuery(e.currentTarget),this.dialog.find(".modal-title").html($this.data("help-title")),this.dialog.find(".modal-body").html($this.data("help-content")),this.dialog.modal("show")})};